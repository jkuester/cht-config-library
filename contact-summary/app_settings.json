{
  "contact_summary": "var ContactSummary = {}; !function(e,t){if('object'==typeof exports&&'object'==typeof module)module.exports=t();else if('function'==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)('object'==typeof exports?exports:e)[n]=r[n]}}(ContactSummary,(()=>{return e={115:(e,t,r)=>{var n=r(972),o=r(610);e.exports=o(n,contact,reports)},610:e=>{function t(e){return e?Array.isArray(e)?e:[e]:[]}function r(e,t){switch(typeof e){case'undefined':return!0;case'function':return e(t);default:return e}}function n(e,t,n){if(r(e.appliesIf,n)){var o='function'==typeof e.fields?e.fields(n):e.fields.filter((function(e){return r(e.appliesIf,n)})).map((function(e){var t={};return i(e,t,'label'),i(e,t,'value'),i(e,t,'translate'),i(e,t,'filter'),i(e,t,'width'),i(e,t,'icon'),e.context&&(t.context={},i(e.context,t.context,'count'),i(e.context,t.context,'total')),t}));return e.modifyContext&&e.modifyContext(t,n),{label:e.label,fields:o}}function i(e,t,r){switch(typeof e[r]){case'undefined':return;case'function':t[r]=e[r](n);break;default:t[r]=e[r]}}}e.exports=function(e,r,o){var i=e.fields||[],s=e.context||{},a=e.cards||[],f=r&&('contact'===r.type?r.contact_type:r.type),c={cards:[],fields:i.filter((function(e){var r=t(e.appliesToType),n=r.filter((function(e){return e&&'!'===e.charAt(0)}));if((0===r.length||r.includes(f)||n.length>0&&!n.includes('!'+f))&&(!e.appliesIf||e.appliesIf()))return delete e.appliesToType,delete e.appliesIf,!0}))};return a.forEach((function(e){var r,i,a,l,p=t(e.appliesToType);if(p.includes('report')&&p.length>1)throw new Error('You cannot set appliesToType to an array which includes the type \\'report\\' and another type.');if(p.includes('report'))for(r=0;r<o.length;++r)i=o[r],!(l=i)||l.errors&&l.errors.length||(a=n(e,s,i))&&c.cards.push(a);else{if(!p.includes(f)&&p.length>0)return;(a=n(e,s))&&c.cards.push(a)}})),c.context=s,c}},972:e=>{const t=[{name:'CHW1',household_visits:1,referrals:2},{name:'CHW2',household_visits:3,referrals:4},{name:'CHW3',household_visits:0,referrals:0}];e.exports={fields:[],cards:[],context:{favorite_chw:t[0],all_chws:{chw_names:t.map((({name:e})=>e)).join(' '),chw_household_visits:t.map((({household_visits:e})=>e)).join(' '),chw_referrals:t.map((({referrals:e})=>e)).join(' ')}}}}},t={},function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}(115);var e,t})); return ContactSummary;",
  "tasks": {
    "rules": "(()=>{var t={0:(t,e,a)=>{var r=a(847),o=a(94);function n(t,e,a,r,o,n){var i;if(t.appliesToType){var c;if('contacts'===t.appliesTo){if(!o.contact)return;c='contact'===o.contact.type?o.contact.contact_type:o.contact.type}else{if(!n)return;c=n.form}if(-1===t.appliesToType.indexOf(c))return}if('scheduled_tasks'===t.appliesTo||!t.appliesIf||t.appliesIf(o,n))if('scheduled_tasks'===t.appliesTo){if(n&&t.appliesIf){if(!n.scheduled_tasks)return;for(i=0;i<n.scheduled_tasks.length;i++)t.appliesIf(o,n,i)&&d(i)}}else d();function s(t,e,a){var r;return(r='function'==typeof t.contactLabel?t.contactLabel(e,a):t.contactLabel)?{name:r}:e.contact}function d(i){var c,d,f,l,u=null;for(c=0;c<t.events.length;c++){if((d=t.events[c]).dueDate)u=d.dueDate(d,o,n,i);else if(n)u=void 0!==i?new Date(e.addDate(new Date(n.scheduled_tasks[i].due),d.days)):new Date(e.addDate(new Date(n.reported_date),d.days));else if(d.dueDate)u=d.dueDate(d,o);else{var v=o.contact&&o.contact.reported_date?new Date(o.contact.reported_date):new Date;u=new Date(e.addDate(v,d.days))}e.isTimely(u,d)&&(l={_id:(n?n._id:o.contact&&o.contact._id)+'~'+(d.id||c)+'~'+t.name,deleted:!(!(o.contact&&o.contact.deleted||n)||!n.deleted),doc:o,contact:s(t,o,n),icon:t.icon,date:u,readyStart:d.start||0,readyEnd:d.end||0,title:t.title,resolved:t.resolvedIf(o,n,d,u,i),actions:p(t.actions,d)},void 0!==i&&(l._id+='-'+i),'function'==typeof(f=t.priority)&&(f=f(o,n)),f&&(l.priority=f.level,l.priorityLabel=f.label),r('task',new a(l)))}}function p(e,a){return t.actions.map((function(t){return function(t,e){var a={source:'task',source_id:n?n._id:o.contact&&o.contact._id,contact:o.contact};t.modifyContent&&t.modifyContent(a,o,n,e);return{type:t.type||'report',form:t.form,label:t.label||'Follow up',content:a}}(t,a)}))}}t.exports=function(t,e,a,i,c){if(t)for(var s,d,p=0;p<t.length;++p)switch('function'!=typeof(s=Object.assign({},t[p],o)).resolvedIf&&(s.resolvedIf=function(t,e,r,o){return s.defaultResolvedIf(t,e,r,o,a)}),r(s),s.appliesTo){case'reports':case'scheduled_tasks':for(var f=0;f<e.reports.length;++f)d=e.reports[f],n(s,a,i,c,e,d);break;case'contacts':e.contact&&n(s,a,i,c,e);break;default:throw new Error('Unrecognised task.appliesTo: '+s.appliesTo)}}},94:t=>{t.exports={defaultResolvedIf:function(t,e,a,r,o){var n,i;o||(o=Utils);var c=function(t){var e;if(!t||!t.actions)return;return(e=t.actions.find((function(t){return!t.type||'report'===t.type})))&&e.form}(this.definition);if(!c)throw new Error('Could not find the default resolving form!');return n=0,n=e?Math.max(o.addDate(r,-a.start).getTime(),e.reported_date+1):o.addDate(r,-a.start).getTime(),i=o.addDate(r,a.end+1).getTime(),o.isFormSubmittedInWindow(t.reports,c,n,i)}}},652:(t,e,a)=>{var r=a(847);function o(t,e,a,r,o,n){var i=!!n;if(o.contact){var c='contact'===o.contact.type?o.contact.contact_type:o.contact.type,s=i?n.form:c;if(!(t.appliesToType&&t.appliesToType.indexOf(s)<0)&&(!t.appliesIf||t.appliesIf(o,n)))for(var d=i?n:o.contact,p=function(t,e,a){var r;return r='function'==typeof t.idType?t.idType(e,a):'report'===t.idType?a&&a._id:e.contact&&e.contact._id,Array.isArray(r)||(r=[r]),r}(t,o,n),f=!t.passesIf||!!t.passesIf(o,n),l=function(t,e,a,r){if('function'==typeof t.date)return t.date(a,r)||e.now().getTime();if(void 0===t.date||null===t.date||'now'===t.date)return e.now().getTime();if('reported'===t.date)return r?r.reported_date:a.contact.reported_date;throw new Error('Unrecognised value for target.date: '+t.date)}(t,a,o,n),u=t.groupBy&&t.groupBy(o,n),v=0;v<p.length;++v){var y=new e({_id:p[v]+'~'+t.id,contact:o.contact,deleted:!!d.deleted,type:t.id,pass:f,groupBy:u,date:l});t.emitCustom?t.emitCustom(m,y,o,n):m(y)}}function m(t){r('target',t)}}t.exports=function(t,e,a,n,i){for(var c=0;c<t.length;++c){var s=t[c];switch(r(s),s.appliesTo){case'contacts':o(s,n,a,i,e);break;case'reports':for(var d=0;d<e.reports.length;++d){o(s,n,a,i,e,e.reports[d])}break;default:throw new Error('Unrecognised target.appliesTo: '+s.appliesTo)}}}},847:t=>{function e(t,a){var r=Object.keys(t);for(var o in r){var n=r[o];switch(typeof t[n]){case'object':e(t[n],a);break;case'function':t[n]=t[n].bind(a)}}}function a(t){var e=Object.assign({},t),r=Object.keys(e);for(var o in r){var n=r[o];if(Array.isArray(e[n])){e[n]=e[n].slice(0);for(var i=0;i<e[n].length;++i)'object'==typeof e[n][i]&&(e[n][i]=a(e[n][i]))}else'object'==typeof e[n]&&(e[n]=a(e[n]))}return e}t.exports=function(t){var r={};e(t,r),r.definition=a(t)}},931:t=>{t.exports=[]},991:t=>{t.exports=[]}},e={};function a(r){var o=e[r];if(void 0!==o)return o.exports;var n=e[r]={exports:{}};return t[r](n,n.exports,a),n.exports}var r=a(991),o=a(931),n=a(0);a(652)(o,c,Utils,Target,emit),n(r,c,Utils,Task,emit),emit('_complete',{_id:!0})})();",
    "isDeclarative": true,
    "targets": {
      "enabled": true,
      "items": []
    }
  }
}
